# ğŸšš CVRP Solution Cost Prediction: Supervised Learning Challenge

![Python](https://img.shields.io/badge/Python-3.9-blue)
![Status](https://img.shields.io/badge/Project-Completed-brightgreen)

> ğŸ” Predicting and classifying the quality of CVRP solutions using regression and classification models.

---

## ğŸ“Œ Overview

This project explores a machine learning-based approach to understanding and predicting the **solution cost** of the Capacitated Vehicle Routing Problem (CVRP). Rather than solving CVRP directly, our goal was to:

- ğŸ”¢ **Predict** the solution cost using regression models
- ğŸ·ï¸ **Classify** solutions into categories of quality (Excellent, Good, Average, Bad)
- ğŸ” Understand the most **influential features** driving solution quality

---

## ğŸ“ Dataset Description

The dataset consists of **CVRP solution instances** generated by a genetic algorithm. It contains numerical statistical features (e.g., `S1` to `S18`) derived from the problem-solving process.

- âœ¨ **Instance-specific features**: e.g. `Instance name`, `Solution cost`
- ğŸ§¹ Several features were removed due to redundancy or perfect correlation:
  - Dropped: `S7` (missing), `S2`, `S4`, `S6`, `S14`, `S15`, `S17`, `S13`
- ğŸ“ Feature normalization was performed prior to modeling

---

## ğŸ”§ Data Preparation

### âœ… Cleaning & Feature Engineering
- Removed features with null values or high correlation
- Created a combined `DataFrame` of all datasets
- Verified absence of nulls post-cleaning

### ğŸ” Sampling Strategy
- Regression: A **0.01% sample** was found representative and used
- Classification: A larger **25% sample** was selected for robust category distribution

### ğŸ”„ Normalization
- Regression: Standard normalization using `StandardScaler`
- Classification: `MinMaxScaler` used per instance group to normalize cost between 0 and 1 (best = 0, worst = 1)

---

## ğŸ“Š Regression Models Benchmark

We tested several models to predict **solution cost**:

- Linear Regression
- Support Vector Regression (SVR)
- Random Forest Regressor
- XGBoost Regressor
- Convolutional Neural Network (CNN)

### ğŸ§ª Evaluation Metrics

- RMSE (Root Mean Squared Error)
- MAE (Mean Absolute Error)
- MSE (Mean Squared Error)
- RÂ² Score

### âœ… Key Findings

- **Random Forest**, **XGBoost**, and **CNN** performed best on both training and test sets
- All models demonstrated **strong generalization** capability through cross-validation

---

## ğŸ·ï¸ Classification Task

We transformed the regression problem into a **4-class classification task**, where cost was binned into categories:

- **Excellent**
- **Good**
- **Average**
- **Bad**

### âš–ï¸ Class Rebalancing

Initial class imbalance caused biased predictions. We rebalanced classes using the minority class count (176,296 samples per class), which significantly improved model performance.

### ğŸ“¦ Models Used

- Random Forest Classifier
- Logistic Regression

> Features used: Only normalized statistical features (`S` columns). Target (`Cost Category`) and `Solution Cost` were removed to prevent leakage.

### ğŸ“Š Results

- **Random Forest** outperformed Logistic Regression in both **accuracy** and **recall**
- Most important features: `S5`, `S11`, `S8`, and `S16` (aligned with PCA results)

---

## ğŸ“ˆ Model Validation

- Confusion matrices showed most errors occurred between **"Excellent"** and **"Bad"** predictions
- Manual **cross-validation** confirmed consistency and generalization of results on new samples

---

## ğŸ“Œ Key Insights

- ğŸ§  Feature engineering and normalization significantly improved model accuracy
- ğŸ·ï¸ Class balancing was crucial to avoid biased classification
- ğŸ” Important features identified matched expectations from earlier unsupervised work (e.g. PCA)
- ğŸ¯ Regression and classification both performed well with appropriate preprocessing

---

## ğŸ§¾ Conclusion

Through this supervised learning challenge, we demonstrated the ability to:

- **Predict the cost** of a CVRP solution
- **Classify the quality** of a solution using machine learning
- Use meaningful **feature engineering** to improve accuracy
- Validate model robustness with **cross-validation and rebalancing**

This framework could assist in **evaluating metaheuristic solutions** before they are deployed or selected.

---

## ğŸ‘¥ Authors

Ricardo Fernandez | Sarra Mahmoudi | Chenjie Qian | Soumiya Razzouk | Daniel Teran

---

## ğŸ“‚ Repository Structure

```bash
.
â”œâ”€â”€ data/                # Raw and processed dataset files
â”œâ”€â”€ notebook             # Jupyter notebooks for regression and classification
â””â”€â”€ README.md            # Readme 
